# 쿼리 작성 및 최적화
## MySQL 연산자와 내장함수 
### 리터럴 표기
문자열
- SQL 표준에서는 홑따옴표`(')`를 사용한다
- 문자열에 홑따옴표가 있으면 2번 연속해서 사용한다
- MySQL에서는 문자열에 쌍따옴표도 허용하지만, 가능하면 표준을 이용하자

숫자
- 문자열 타입과 숫자 타입을 비교하면 숫자를 우선시하기 때문에 문자열을 숫자로 변환하고 비교한다
   ```sql
   -- 아래 쿼리에서는 string_column이 숫자로 변경되어 비교된다. 이 경우 인덱스를 사용할 수 없다
   select * from test where string_column = 10001;
   ```
날짜
- 정해진 날짜 포멧을 이용하면 MySQL 서버가 자동으로 변환해주기 때문에 'STR_TO_DATE' 같은 함수를 사용하지 않아도 된다

불리언
- BOOL, BOOLEAN 타입이 있지만 TINYINT의 동의어일 뿐이다. BOOL로 생성하고 조회해보면 TINYINT로 생성된다
- true는 1, false는 0으로 저장된다
- 2, 3, 4, 5도 저장이 되는데 조회 조건에 true, false를 입력하면 이 값들은 조회되지 않는다

### MySQL 연산자
동등 비교
- `=`: 동등 비교
   ```
   1 = 1 : true
   null = null : null   // null 은 isnull로만 비교할 수 있다
   1 = null : null
   ```
- `<=>`: 동등 비교 + null에 대한 비교까지 수행한다. null을 하나의 값으로 인식한다
   ```
   1 <=> 1 : true
   null <=> null : true
   1 <=> null: false
   ```
REGEXP
- 정규식 비교를 수행한다
   ```sql
   -- abc 문자열 값이 x,y,z로 시작하는지 확인
   select 'abc' REGEXP '^[x-y]';
   ```
- 인덱스 레인이 조건을 사용할 수 없다. 따라서 범위를 줄일 수 있는 다른 조건과 함께 사용하는게 좋다

LIKE 
- `%` 문자가 뒤에 온다면 인덱스 레인지 스캔을 사용할 수 있다

BETWEEN
- '크거나 같다', '작거나 같다' 2개의 연산을 하나로 합친 연산자
- 선형으로 인덱스를 검색한다. 
- `IN` 연산은 동등 비교를 여러번 수행하는데, 비교하는 항목이 작다면 IN으로 조회하는게 성능이 더 좋을 수 있다. 
   - IN의 항목을 가져오기 위해서 추가적인 쿼리를 수행하는 것은 효율성이 있는지 성능을 확인해보는게 필요하다. 더 나쁜 결과를 가져올 수 있기 때문에 서브쿼리는 주의해야한다. 

IN
- 범위 검색을 하는게 아니라, 여러 번의 동등 비교로 수행되기 때문에 일반적으로 빠르게 처리된다
- __주의 사항__
   - In 연산자의 입력이 상수라면 성능이 좋지만, 서브쿼리는 상당히 느려질 수 있다. 서브쿼리의 외부가 먼저 실행되고, In은 체크조건으로 사용된다. 
   - Not In은 인덱스 풀스캔을 하게 된다
- In 입력으로 상수를 사용한다면 상수를 수만 개 수준으로 사용하지 않는다면 문제가 되지 않는다. 